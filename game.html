<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>This Is How We Cope - Game</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Loading Container -->
  <div id="loadingContainer">
    <div id="loadingLine"></div>
  </div>

  <!-- Main Content -->
  <div id="mainContent" style="display: none;">
    <div class="flip-container" onclick="flipCard()">
      <div class="card" id="flipCard">
        <div class="front" id="cardFront"></div>
        <div class="back" id="cardBack"></div>
      </div>
    </div>
    <p id="guidanceText" class="guidance-text-desktop">tap card to view guidance</p>
    <button class="deal2" onclick="loadRandomOddImage()">Deal New Card</button>
  </div>

  <!-- Footer -->
  <footer class="gamef">
    <p><a href="https://copingwithcapitalism.com">Coping With Capitalism Â©2023</a></p>
  </footer>

  <!-- JavaScript -->
  <script>
    const allImages = [
      // Image array content...
    ];

    // Shuffle array function
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // Filter and shuffle odd images
    let oddImages = shuffle(allImages.filter((img, index) => (index + 1) % 2 !== 0));
    let usedImages = [];

    function loadRandomOddImage() {
      if (oddImages.length === 0) {
        oddImages = shuffle(usedImages);
        usedImages = [];
      }

      let frontImageUrl = oddImages.pop();
      usedImages.push(frontImageUrl);
      let backImageUrl = getNextImage(frontImageUrl);

      document.getElementById('cardFront').style.backgroundImage = `url('https://raw.githubusercontent.com/shawnjr222/thisishowwecope/main/img/${frontImageUrl}')`;
      document.getElementById('cardBack').style.backgroundImage = `url('https://raw.githubusercontent.com/shawnjr222/thisishowwecope/main/img/${backImageUrl}')`;
      document.getElementById('flipCard').classList.remove('flipped');
    }

    function getNextImage(currentImage) {
      let currentNumber = parseInt(currentImage.match(/\d+/)[0], 10);
      let nextNumber = currentNumber + 1;
      return allImages.find(img => img.startsWith(String(nextNumber).padStart(2, '0'))) || '01.png';
    }

    let flipCount = 0;

    function flipCard() {
      document.getElementById('flipCard').classList.toggle('flipped');
      flipCount++;
      if (flipCount === 2) {
        document.getElementById('guidanceText').classList.add('guidance-fade-out');
        document.querySelector('.deal2').classList.add('button-slide-up');
      }
    }

    // Loading animation logic
    document.addEventListener("DOMContentLoaded", function() {
      document.getElementById('loadingLine').style.width = '100%';

      setTimeout(function() {
        document.getElementById('loadingContainer').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
        document.getElementById('guidanceText').style.display = 'block';
        document.querySelector('.deal2').style.display = 'block';

        loadRandomOddImage();
      }, 3000); // Adjust the timeout as per your loading time
    });
  </script>
</body>
</html>
