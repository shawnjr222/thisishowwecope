<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>This Is How We Cope - Game</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div id="loading-container">
    <div id="loading-bar"></div>
</div>
<!-- The rest of your Page 2 content follows -->
  <div class="container">
   <div class="flip-container" onclick="flipCard()">
  <div class="card" id="flipCard">
    <div class="front" id="cardFront"></div>
    <div class="back" id="cardBack"></div>
  </div>
  </div>
    <p id="guidanceText" class="guidance-text-desktop">tap card to view guidance</p>
    <button class="deal2" onclick="loadRandomOddImage()">Deal New Card</button>
    <footer class="gamef">
      <p><a href="https://copingwithcapitalism.com">Coping With Capitalism Â©2023</a></p>
    </footer>
  </div>
  <script>
  const allImages = [
   '01.png', 
'02.png', 
'03.png', 
'04.png', 
'05.png', 
'06.png', 
'07.png', 
'08.png', 
'09.png', 
'10.png', 
'11.png', 
'12.png', 
'13.png', 
'14.png', 
'15.png', 
'16.png', 
'17.png', 
'18.png', 
'19.png', 
'20.png', 
'21.png', 
'22.png', 
'23.png', 
'24.png', 
'25.png', 
'26.png', 
'27.png', 
'28.png', 
'29.png', 
'30.png', 
'31.png', 
'32.png', 
'33.png', 
'34.png', 
'35.png', 
'36.png', 
'37.png', 
'38.png', 
'39.png', 
'40.png', 
'41.png', 
'42.png', 
'43.png', 
'44.png', 
'45.png', 
'46.png', 
'47.png', 
'48.png', 
'49.png', 
'50.png', 
'51.png', 
'52.png', 
'53.png', 
'54.png', 
'55.png', 
'56.png', 
'57.png', 
'58.png', 
'59.png', 
'60.png', 
'61.png', 
'62.png',
'63.png',
'64.png',
'65.png',
'66.png',
'67.png',
'68.png',
'69.png',
'70.png',
'71.png',
'72.png',
'73.png',
'74.png',
'75.png',
'76.png',
'77.png',
'78.png',
'79.png',
'80.png',
'81.png',
'82.png',
'83.png',
'84.png',
'85.png',
'86.png',
'87.png',
'88.png',
'89.png',
'90.png',
'91.png',
'92.png',
'93.png',
'94.png',
'95.png',
'96.png',
'97.png',
'98.png',
'99.png',
'100.png',
'101.png',
'102.png',
'103.png',
'104.png',
'105.png',
'106.png',
'107.png',
'108.png',
'109.png',
'110.png'
  ];

document.addEventListener("DOMContentLoaded", function() {
    const mainContent = document.querySelector('.container'); // Main content container
    mainContent.style.opacity = 0; // Initially hide main content

    const loadingBar = document.getElementById("loading-bar");
    const loadingContainer = document.getElementById("loading-container");
    loadingContainer.style.opacity = 1; // Show loading container

    let imagesLoaded = 0;
    function imageLoaded() {
        imagesLoaded++;
        const totalImages = allImages.length;
        const width = (imagesLoaded / totalImages) * 100;
        loadingBar.style.width = `${width}%`;

        if(imagesLoaded === totalImages) {
            setTimeout(() => {
                loadingContainer.style.opacity = 0; // Hide loader
                mainContent.style.opacity = 1; // Show main content
            }, 1500); // Slight delay for visual effect
        }
    }

    allImages.forEach(image => {
        const img = new Image();
        img.onload = imageLoaded;
        img.onerror = imageLoaded;
        img.src = `https://raw.githubusercontent.com/shawnjr222/thisishowwecope/main/img/${image}`;
    });
});

    
  // Shuffle array function
  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  // Filter and shuffle odd images
 let oddImages = shuffle(allImages.filter((img, index) => (index + 1) % 2 !== 0));
let usedImages = [];

function loadRandomOddImage() {
  if (oddImages.length === 0) {
    oddImages = shuffle(usedImages);
    usedImages = [];
  }
  
   if (!hasDealtOnce) {
        loadRemainingImages(); // Load the rest of the images after the first deal
        hasDealtOnce = true;
    }

  let frontImageUrl = oddImages.pop();
  usedImages.push(frontImageUrl);
  let backImageUrl = getNextImage(frontImageUrl);

  document.getElementById('cardFront').style.backgroundImage = `url('https://raw.githubusercontent.com/shawnjr222/thisishowwecope/main/img/${frontImageUrl}')`;
  document.getElementById('cardBack').style.backgroundImage = `url('https://raw.githubusercontent.com/shawnjr222/thisishowwecope/main/img/${backImageUrl}')`;
  document.getElementById('flipCard').classList.remove('flipped');
}

function shuffle(array) {
  let currentIndex = array.length, randomIndex;

  // While there remain elements to shuffle...
  while (currentIndex != 0) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // Swap it with the current element.
    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
  }

  return array;
}

function getNextImage(currentImage) {
  let currentNumber = parseInt(currentImage.match(/\d+/)[0], 10);
  let nextNumber = currentNumber + 1;
  return allImages.find(img => img.startsWith(String(nextNumber).padStart(2, '0'))) || '01.png';
}

    let flipCount = 0;

function flipCard() {
  document.getElementById('flipCard').classList.toggle('flipped');
  flipCount++;
  console.log("Flip count: ", flipCount); // Debugging line

  if (flipCount >= 2) {
    document.getElementById('guidanceText').classList.add('guidance-fade-out-desktop');
    document.querySelector('.deal2').classList.add('button-slide-up-desktop');
  }
}

window.onload = loadRandomOddImage;
    
</script>

</body>
</html>
